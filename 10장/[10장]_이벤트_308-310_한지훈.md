# 10장 이벤트

---

## 10.2.3 이벤트 용도

 - 이벤트는 크게 두가지 용도로 쓰인다. 첫 번째 용도는 트리거다
 - 도메인 상태가 바뀔때 다른 후처리가 필요하면 후처리를 실행하기 위한 트리거로 이벤트를 사용할 수 있다.
 - 주문에서는 주문 취소 이벤트를 트리거로 사용할 수 있다. 주문을 취소하면 환불을 처리해야 하는데 이때 환불 처리를 위한 트리거로 주문 취소 이벤트를 사용할 수 있다.

![image_10_4.png](image%2Fimage_10_4.png)

 - 예매 결과를 SMS로 통지할 때도 이벤트를 트리거로 사용할 수 있다. 예매 도메인은 예메 완료 이벤트를 발생시키고 이 이벤트 핸들러에서 SMS를 발송하는 방식으로 구현할 수 있다.
 - 이벤트의 두 번쨰 용도는 서로 다른 시스템 간의 데이터 동기화이다.
 - 배송지를 변경하면 외부 배송 서비스에 바뀐 배송지 정보를 전송해야 하는데, 주문 도메인은 배송지 변경 이벤트를 발생 시키고 이벤트 핸들러는 외부 배송 서비스와 배송지 정보를 동기화할 수 있다.

## 10.2.4 이벤트 장점
 - 이벤트랄 사용하면 서로 다른 도메인 로직이 섞이는 것을 방지할 수 있다.
 - 만약 구매 취소라는 메서드가 있을때 구매 취소 안에 환불 로직이 기존에 있었다면 이를 이벤트로 분리해 구매 취소 발생시 환불에 대한 이벤트를 발생시킬 수 있다.
 - 구매 취소는 비즈니스상 서버측에서 처리해야할 문제이고 보통 외부 서비스를 통해 결제와 환불을 진행하고 자체 결제와 환불 시스템이 없는 경우, 이벤트를 통해 외부 시스템에 대한 의존을 분리해낼 수 있다.
 - 이벤트 핸들러를 통해 기능 확장도 용이하다.
   - 구매 취소시 환불과 함께 이메일로 취소 내용을 보내고 싶다면 이메일 발송을 처리하는 핸들러를 구현하면 되며, 기능을 확장해도 구매 취소 로직을 변경하는 일은 없다.

![image_10_6.png](image%2Fimage_10_6.png)



