# 9.5 바운디드 컨텍스트 간 관계

두 바운디드 컨텍스트는 다양한 방식으로 관계를 맺는다.

---

## 1. API 기반 관계

가장 흔한 관계는 **한쪽에서 API를 제공**하고, **다른 한쪽에서 API를 호출**하는 방식이다.  
대표적인 예: **REST API**

예시:  
- **카탈로그 컨텍스트**는 **추천 컨텍스트**가 제공하는 데이터와 기능에 의존한다.
- 추천 컨텍스트의 **REST API 인터페이스가 바뀌면** 카탈로그도 변경이 필요하다.
![image_9-17.png](image%2Fimage_9-17.png)
### 상류와 하류의 개념
- **상류 (Upstream)**: API **공급자**
- **하류 (Downstream)**: API **소비자**
- 상류의 변화는 하류에 영향을 미치므로 **상호 협력이 필수적**이다.

---

상류 컴포넌트는 하류 컴포넌트가 사용할 수 있는 **통신 프로토콜**을 정의한다.

예:
- REST API
- gRPC, 프로토콜 버퍼 등

하류 팀이 다수 존재하면 상류 팀은:
- 여러 하류 팀의 요구사항을 수용할 수 있는 **공용 API** 제공
- 이를 통해 서비스의 **일관성 유지**

이런 방식을 **공개 호스트 서비스 (Open Host Service)** 라고 한다.

### 예시: 검색 시스템
![image_9-18.png](image%2Fimage_9-18.png)
- **검색 시스템** = 상류 컴포넌트
- **블로그, 카페, 게시판** = 하류 컴포넌트
- 각 서비스별 검색을 구현하는 대신, **전용 검색 시스템을 구축**하고 각 서비스와 통합

---

#### 하류의 완충 지대 (Anti-Corruption Layer)
![image_9-19.png](image%2Fimage_9-19.png)
하류 컴포넌트는 상류 서비스의 모델이 **자신의 도메인 모델에 직접 영향을 주지 않도록** 보호해야 한다.  
→ 이를 위해 **완충 지대(ACL, Anti-Corruption Layer)** 를 만든다.

---

## 2. 공유 커널 (Shared Kernel)

운영자를 위한 주문관리 도구를 개발하는 팀과 고객을 위한 주문서비스를 개발하는 팀이 다르다고 할때

두 팀이 **공통 모델을 공유**함으로써 **중복 설계를 줄임**

이렇게 팀이 공유하는 모델을 공유커널 이라고 한다.

공유커널의 장점은 중복을 줄여준다. 하지만 두팀이 한 모델을 동유하기 때문에 한팀에서 임의로 변경해선 안되면 두팀이 밀접한 관계를 유지해야한다. 밀접한 관계가 아닐시엔 공유커널로 인해 개발이 지연되고 정체되는 문제가 생기게 된다.

---

## 3. 독립 방식 (Separate Ways)

- 두 컨텍스트를 **통합하지 않고 독립적으로 발전**
- **통합은 수동으로 수행**

예:
![image_9-20.png](image%2Fimage_9-20.png)

- **온라인 쇼핑몰**과 **외부 ERP 서비스**
- 쇼핑몰에서 판매 발생 → 
온라인 쇼핑몰은 외부 ERP 서비스와 연동을 지원하지 않으므로
쇼핑몰 시스템에서 판매 정보를 보고 운영자가 ERP에 **직접 입력**

### 특징
- 초기에는 **수동 통합도 가능**
- 하지만 규모가 커지면 **자동화 필요**
- 완전한 통합이 어렵다면 **별도의 통합 시스템** 개발 필요

![image_9-21.png](image%2Fimage_9-21.png)