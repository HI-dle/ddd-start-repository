# 1.7 도메인 용어와 유비쿼터스 언어

코드를 작성할 때 도메인에서 사용하는 용어는 매우 중요합니다. 도메인에서 사용하는 용어를 코드에 반영하지 않으면, 그 코드는 개발자에게 코드의 의미를 해석해야하는 부담을 줍니다.

예를 들어 아래 `OrderStatus`를 보겠습니다.

```java
public enum OrderStatus {
  STEP1, STEP2, STEP3, STEP4, STEP5, STEP6
}
```

실제 주문 상태는 아래와 같은데,
- 결제 대기 중
- 상품 준비 중
- 출고 완료됨
- 배송 중
- 배송 완료됨
- 주문 취소됨

개발자가 각 상태를 `STEP` 으로 표현하게 되면서 `Order` 코드를 아래와 같이 작성할 가능성이 높습니다.
```java
public class Order {
  public void changeShippingInfo(ShippingInfo newShippingInfo) {
    verifyStep10orStep2();
    setShippingInfo(newShippingInfo);
  }
  
  private void verifyStep1orStep2() {
    if (state != OrderState.STEP1 && state != OrderState.STEP2) {
      throw new IllegalStateException("already shipped");
    }
  }
}
```
`배송지 변경(changeShippingInfo)`은 '출고 전'에 가능한데, 이 코드의 `verifyStep10orStep2()`라는 이름에는 주용한 도메인 규칙이 드러나지 않습니다.

그저 STEP1이나 2인지만 검사할 뿐입니다.

실제 이 코드를 이해하기 위해서는 결국 `STEP1과 STEP2`가 각각 `결제 대기 중, 상품 준비 중`을 의미한다는 것을 알아야 합니다.

또한 기획자나 온라인 쇼핑 도메인 전문가가 개발자와의 업무 회의에서 `출고 전`이라는 단어를 사용하면 개발자는 머릿속으로 `STEP1과 STEP2`라고 `도메인 지식을 코드로 해석`해야합니다.

따라서 `STEP` 으로 작성되어 있던 코드를 아래와 같이 변경한다면, 이런 불필요한 변환 작업을 거치지 않아도 됩니다.
```java
public enum OrderState {
  PAYMENT_WAITING, PREPARING, SHIPPED, DELIVERING, DELIVERY_COMPLETED
  ;
}
```

> `출고 전(SHIPPED)`은 `STEP1 이나 STEP2`가 아닌, `PAYMENT_WAITING 이나 PREPARING(결제 대기 중, 상품 준비 중)` 이라고 바로 이해할 수 있게 됩니다.
> 
> **따라서 개발자가 도메인 용어를 코드로 해석하는 과정이 줄어들고, 이는 의미를 변환하는 과정에서 발생하는 버그도 줄어들게 됩니다.**

---
에릭 에반스는 도메인 주도 설계에서 언어의 중요함을 강조하기 위해 `유비쿼터스 언어(ubiquitous language)`라는 용어를 사용했습니다.

전문가, 관계자, 개발자가 도메인과 관련된 공통의 언어를 만들고 이를 대화, 문서, 도메인 모델, 코드, 테스트 등 모든 곳에서 같은 용어를 사용합니다. 

이렇게 하면 소통 과정에서 발생하는 **`용어의 모호함`을 줄일 수** 있고, 개발자는 도메인과 코드 사이에서 **`불필요한 코드 해석`을 줄일 수** 있게 됩니다.

시간이 지날수록 도메인에 대한 이해가 높아지는데 새롭게 이해한 내용을 잘 표현할 수 있는 용어를 찾아내고 이를 다시 공통의 언어로 만들어 다 같이 사용합니다.
새로 발견한 용어는 코드나 문서에도 반영해서 산출물에 최신 모델을 적용합니다.

---
도메인 용어는 좋은 코드를 만드는데 분명히 중요한 요소입니다. 하지만 `국내 개발자`는 이 점에 있어 `영어`라는 불리한 점이 있습니다.

이는 분야의 특성상 알파벳과 숫자를 사용해서 클래스, 필드, 메서드 등의 이름을 작성하게 되는데 이것은 도메인 용어를 영어로 해석하는 노력이 필요함을 뜻합니다.

- 도메인에서 사용하는 `용어의 의미를 명확하게 전달하는 영단어를 찾기 힘든` 경우
- 반대로 `비슷한 의미의 영단어`가 많으면 각 단어의 뉘앙스나 `미세한 차이를 몰라서 선택하기 어려운` 경우

예를 들어, '상태'라는 용어를 `state와 status`중 무엇을 선택해야할 지, '종류'(`king or type`)중 어떤 단어가 맞는 지 등이 있습니다.
그냥 이해하기 쉽게 `gubun(구분)`과 같은 이름을 사용하기도 합니다.

알맞은 영단어를 찾는 것은 쉽지 않은 일이지만 시간을 들여 찾는 노력을 해야합니다. 

**적당한 단어를 찾는 노력을 하지 않고, 도메인에 어울리지 않는 단어를 사용하면 코드는 도메인과 점점 멀어지게 됩니다.**

그러니 도메인 용어에 알맞은 단어를 찾는 시간을 아까워하지 말아야합니다.
